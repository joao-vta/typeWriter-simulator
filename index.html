<html>
<head>
<style>
@font-face { font-family: typeWriter; src: url('resources/atwriter_2.ttf'); } 
body {
	background-image: url('resources/test_2.jpg');
	background-size: cover;
}
#demo{
	color:red;
}
#pagina{
	font-size: 26px;
	font-family: 'typeWriter', 'monospace';
	margin-right: 10%;
	box-shadow: 11px 11px 3px;
}
div {
	height: 80%;
	width: 30%;
	background-color: white;
	float: right;
}
#myimg{
	width:45%;
	float: left;
}
</style>
 <script>
 	var charMap = [
	["a", 0.333, 0.771],
	["b", 0.571, 0.829],
	["c", 0.464, 0.832],
	["d", 0.442, 0.771],
	["e", 0.422, 0.708],
	["f", 0.489, 0.771],
	["g", 0.541, 0.769],
	["h", 0.596, 0.771],
	["i", 0.682, 0.705],
	["j", 0.645, 0.771],
	["k", 0.695, 0.771],
	["l", 0.752, 0.777],
	["m", 0.675, 0.829],
	["n", 0.620, 0.832],
	["o", 0.739, 0.705],
	["p", 0.784, 0.711],
	["q", 0.325, 0.711],
	["r", 0.476, 0.708],
	["s", 0.387, 0.777],
	["t", 0.531, 0.705],
	["u", 0.633, 0.700],
	["v", 0.516, 0.835],
	["w", 0.372, 0.711],
	["x", 0.414, 0.835],
	["y", 0.578, 0.705],
	["z", 0.360, 0.835]
	]
	const LETTER_DETEC_THRESHOLD = 0.00085;
	var img;
	var pagina;
	var audio = new Audio("resources/audio1_2.wav");

	var palavra = "";
	function addLetterToWord(event) {
		var x = (event.clientX - img.offsetLeft)/ img.width;
		var y = (event.clientY - img.offsetTop) / img.height;

		document.getElementById("demo").innerHTML = "Clique em uma letra | " 
		+ x.toFixed(3) + ", " + y.toFixed(3);
		
		// Checks every letter for proximity to click
		var foundLetter = false;
		charMap.forEach(function (item, index) {
			if (((Math.pow(x - item[1], 2) + Math.pow(y - item[2], 2)) < LETTER_DETEC_THRESHOLD)
			 && (!foundLetter)){
				console.log(item[0]);

				palavra = palavra + item[0];

				foundLetter = true;
			}
		});
		if(foundLetter){
			audio.play();
			pagina.innerHTML = "Texto: " + "<br>" + palavra;
		}
	}

	function changePointerOnLetter(event){
		var x = (event.clientX - img.offsetLeft)/ img.width;
		var y = (event.clientY - img.offsetTop) / img.height;

		var foundLetter = false;
		charMap.forEach(function (item, index) {
			if (((Math.pow(x - item[1], 2) + Math.pow(y - item[2], 2)) < LETTER_DETEC_THRESHOLD)
			 && (!foundLetter)){
				foundLetter = true;
			}
		});

		if(foundLetter){
			img.style.cursor='pointer';
		}
		else{
			img.style.cursor='auto';
		}
	}

	window.onload = function(){
		img = document.getElementById("myimg");
		pagina = document.getElementById("pagina");
		img.addEventListener("click", addLetterToWord);
		document.onmousemove = changePointerOnLetter;
	};
</script>
</head>

<body>
	<p id="demo">Clique em uma letra</p>
	<img id="myimg" src="resources/44_4.png"
	 alt="Italian Trulli"
	 >

	 <div id = "pagina">
	 Texto:<br>
	 </div>
</body>

 <!--<script>
 	var charMap = [
	['a'],
	['b'],
	['c'],
	['d'],
	['e'],
	['f'],
	['g'],
	['h'],
	['i'],
	['j'],
	['k'],
	['l'],
	['m'],
	['n'],
	['o'],
	['p'],
	['q'],
	['r'],
	['s'],
	['t'],
	['u'],
	['v'],
	['w'],
	['x'],
	['y'],
	['z'],
	];

	var counter = 0;
	var palavra = "";
	function myFunction(thing) {
		var img = document.getElementById("myimg")
		
		var x = (thing.clientX - img.offsetLeft)/ img.width;
		var y = (thing.clientY - img.offsetTop) / img.height;
		document.getElementById("demo").innerHTML = "X coords: " + x.toFixed(3) + ", Y coords: " + y.toFixed(3)+ " | " + x.toFixed(2)+ ", " + y.toFixed(2);

		charMap[counter].push(x);
		charMap[counter].push(y);
		
		counter = counter + 1;
		
		if(counter == 25){
			charMap.forEach(function (item, index) {
				if(index < 25){
					palavra += "[";
					palavra += item[0];
					palavra += ",";
					palavra += item[1].toFixed(3);
					palavra += ",";
					palavra += item[2].toFixed(3);
					palavra += "],\n";
				}
			});
			console.log(palavra);
		}
	}

	window.onload = function(){
		document.getElementById("myimg").addEventListener("click", myFunction);  
	};
</script>
</head>
-->